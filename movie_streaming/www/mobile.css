/**
 * Mobile-specific styles for MovieStreaming Android App
 * Includes: Safe area insets, touch enhancements, TV/tablet support
 */

/* ============================================
   Safe Area Insets (for notches, rounded corners)
   ============================================ */
:root {
    --safe-area-inset-top: env(safe-area-inset-top, 0px);
    --safe-area-inset-right: env(safe-area-inset-right, 0px);
    --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
    --safe-area-inset-left: env(safe-area-inset-left, 0px);
}

/* Apply safe area padding to main container */
#app {
    padding-top: var(--safe-area-inset-top);
    padding-bottom: var(--safe-area-inset-bottom);
    padding-left: var(--safe-area-inset-left);
    padding-right: var(--safe-area-inset-right);
}

/* Header with safe area */
header {
    padding-top: max(0.5rem, var(--safe-area-inset-top));
}

/* Bottom ad banner with safe area */
#ad-banner-bottom {
    padding-bottom: var(--safe-area-inset-bottom);
}

/* ============================================
   Touch-Friendly Enhancements
   ============================================ */

/* Larger touch targets for mobile */
@media (max-width: 768px) {
    /* Increase button sizes */
    button, 
    .category-link, 
    a[href] {
        min-height: 44px;
        min-width: 44px;
    }
    
    /* Larger tap area for media cards */
    .media-card,
    .home-card {
        cursor: pointer;
        -webkit-tap-highlight-color: rgba(229, 62, 62, 0.3);
    }
    
    /* Search input touch optimization */
    #search-input,
    #iptv-search {
        font-size: 16px !important; /* Prevents iOS zoom on focus */
        min-height: 44px;
    }
    
    /* Dropdown touch optimization */
    select {
        font-size: 16px !important;
        min-height: 44px;
    }
    
    /* Sidebar links larger touch area */
    #sidebar nav a,
    #sidebar nav button {
        min-height: 48px;
        display: flex;
        align-items: center;
    }
}

/* ============================================
   Mobile-Specific Layout Adjustments
   ============================================ */

/* Full height on mobile without address bar issues */
@supports (-webkit-touch-callout: none) {
    #app {
        min-height: -webkit-fill-available;
    }
}

/* Prevent pull-to-refresh on Android */
body {
    overscroll-behavior-y: contain;
}

/* Smoother scrolling on mobile */
#main-content,
#sidebar,
#recommendations-grid {
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
}

/* Video fullscreen adjustments */
.video-container.fullscreen {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    z-index: 9999 !important;
    padding-bottom: 0 !important;
    background: #000 !important;
}

.video-container.fullscreen iframe {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
}

/* Hide UI elements in fullscreen */
body.video-fullscreen header,
body.video-fullscreen #sidebar,
body.video-fullscreen #ad-banner-top,
body.video-fullscreen #ad-banner-bottom,
body.video-fullscreen #ad-banner-middle {
    display: none !important;
}

/* ============================================
   Tablet Layout (landscape and portrait)
   ============================================ */

@media (min-width: 768px) and (max-width: 1024px) {
    /* Two-column layout for tablets */
    #media-grid {
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 1rem;
    }
    
    /* Watch page adjustments */
    #watch-page .lg\\:flex {
        flex-direction: column;
    }
    
    #watch-page .lg\\:w-2\\/3,
    #watch-page .lg\\:w-1\\/3 {
        width: 100%;
    }
    
    /* Recommendations horizontal on tablet */
    #recommendations-grid {
        display: flex;
        flex-wrap: nowrap;
        overflow-x: auto;
        gap: 1rem;
        max-height: none;
    }
    
    #recommendations-grid .recommendation-card {
        flex-shrink: 0;
        width: 200px;
    }
}

/* Tablet landscape */
@media (min-width: 768px) and (max-width: 1024px) and (orientation: landscape) {
    /* Side-by-side layout for video and recommendations */
    #watch-page .lg\\:flex {
        flex-direction: row;
    }
    
    #watch-page > div > div:first-child {
        width: 60%;
    }
    
    #watch-page > div > div:last-child {
        width: 40%;
    }
    
    #recommendations-grid {
        flex-direction: column;
        overflow-x: hidden;
        overflow-y: auto;
        max-height: 70vh;
    }
    
    #recommendations-grid .recommendation-card {
        width: 100%;
    }
}

/* ============================================
   Android TV / Large Screen Support
   ============================================ */

/* TV detection: very large screens, typically 1080p+ */
@media (min-width: 1280px) and (min-height: 720px) {
    /* Larger text for TV viewing distance */
    .tv-mode body {
        font-size: 1.2rem;
    }
    
    .tv-mode h1, .tv-mode h2, .tv-mode h3 {
        font-size: 1.5em;
    }
    
    /* Larger cards for TV */
    .tv-mode .media-card,
    .tv-mode .home-card {
        transform: scale(1.1);
        margin: 0.5rem;
    }
    
    /* Focus states for D-pad navigation */
    .tv-mode .media-card:focus,
    .tv-mode .home-card:focus,
    .tv-mode button:focus,
    .tv-mode a:focus,
    .tv-mode select:focus,
    .tv-mode input:focus {
        outline: 3px solid #e53e3e !important;
        outline-offset: 4px;
        transform: scale(1.05);
        transition: transform 0.2s ease, outline 0.2s ease;
    }
    
    /* Make all interactive elements focusable */
    .tv-mode .media-card,
    .tv-mode .home-card {
        tabindex: 0;
    }
}

/* ============================================
   D-Pad Navigation Support
   ============================================ */

/* Focus visible for keyboard/D-pad navigation */
.media-card:focus-visible,
.home-card:focus-visible,
.category-link:focus-visible,
button:focus-visible,
a:focus-visible {
    outline: 2px solid #e53e3e;
    outline-offset: 2px;
}

/* Focus within for card containers */
.media-card:focus-within,
.home-card:focus-within {
    transform: scale(1.02);
    z-index: 10;
}

/* ============================================
   Performance Optimizations for Mobile
   ============================================ */

/* Hardware acceleration for animations */
.media-card,
.home-card,
#sidebar,
.video-container {
    transform: translateZ(0);
    will-change: transform;
}

/* Reduce animations on low-power mode */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* ============================================
   Loading States for Mobile Networks
   ============================================ */

/* Skeleton loading for slow connections */
.skeleton {
    background: linear-gradient(90deg, #1a1a1a 25%, #2d2d2d 50%, #1a1a1a 75%);
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s infinite;
}

@keyframes skeleton-loading {
    0% {
        background-position: 200% 0;
    }
    100% {
        background-position: -200% 0;
    }
}

/* ============================================
   Capacitor-Specific Styles
   ============================================ */

/* Status bar overlay mode */
body.capacitor-statusbar-overlay header {
    padding-top: calc(var(--safe-area-inset-top) + 24px);
}

/* Hide web-specific elements in app */
.capacitor-app .web-only {
    display: none !important;
}

/* Show app-specific elements */
.app-only {
    display: none;
}

.capacitor-app .app-only {
    display: block;
}

/* ============================================
   Portrait Video on Mobile
   ============================================ */

@media (max-width: 768px) and (orientation: portrait) {
    /* Smaller video in portrait */
    .video-container {
        padding-bottom: 56.25%; /* Keep 16:9 */
    }
    
    /* Suggest rotation overlay */
    .rotate-suggestion {
        position: fixed;
        bottom: 100px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 9999px;
        font-size: 0.875rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        z-index: 100;
        animation: fadeInOut 3s ease-in-out;
    }
    
    @keyframes fadeInOut {
        0%, 100% { opacity: 0; }
        20%, 80% { opacity: 1; }
    }
}

/* ============================================
   Dark Mode Enhancements
   ============================================ */

/* Ensure dark mode on all Android versions */
@media (prefers-color-scheme: dark) {
    :root {
        color-scheme: dark;
    }
    
    body {
        background-color: #0f0f0f;
        color: #f1f1f1;
    }
}

/* Force dark mode for Capacitor app */
.capacitor-app {
    color-scheme: dark;
}

/* ============================================
   Accessibility Improvements
   ============================================ */

/* High contrast mode support */
@media (prefers-contrast: high) {
    .media-card,
    .home-card {
        border: 2px solid #fff;
    }
    
    button, a {
        border: 1px solid currentColor;
    }
}

/* Larger text support */
@media (min-resolution: 2dppx) {
    /* Sharper images on high DPI screens */
    img {
        image-rendering: -webkit-optimize-contrast;
    }
}
